<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>METTA ‚Ä¢ –¢–µ—Å—Ç –ø–æ—Å–∞–¥–∫–∏</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    * { box-sizing: border-box; }

    body {
      margin: 0;
      padding: 0;
      min-height: 100vh;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
      background: radial-gradient(circle at top, #e5e7eb 0, #f3f4f6 45%, #e5e7eb 100%);
      color: #020617;
      display: flex;
      justify-content: center;
    }

    .shell {
      width: 100%;
      max-width: 480px;
      padding: 12px 10px;
    }

    .card {
      width: 100%;
      height: calc(100vh - 24px);
      max-height: 780px;
      background: #f9fafb;
      border-radius: 22px;
      padding: 18px 16px 12px;
      box-shadow:
        0 18px 40px rgba(148,163,184,0.65),
        0 0 0 1px rgba(148, 163, 184, 0.6);
      border: 1px solid rgba(148, 163, 184, 0.7);
      display: flex;
      flex-direction: column;
      position: relative;
      overflow: hidden;
    }

    .header {
      display: flex;
      justify-content: space-between;
      gap: 12px;
      margin-bottom: 8px;
      align-items: center;
    }

    .badge {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      font-size: 11px;
      padding: 4px 10px;
      border-radius: 999px;
      background: rgba(59,130,246,0.08);
      color: #1d4ed8;
      text-transform: uppercase;
      letter-spacing: 0.04em;
      font-weight: 600;
    }

    .badge-dot {
      width: 8px;
      height: 8px;
      border-radius: 999px;
      background: #22c55e;
      box-shadow: 0 0 0 4px rgba(34,197,94,0.2);
    }

    h1 {
      margin: 4px 0 2px;
      font-size: 20px;
      color: #020617;
    }

    .subtitle {
      font-size: 13px;
      color: #4b5563;
      max-width: 260px;
    }

    .logo {
      display: flex;
      flex-direction: column;
      align-items: flex-end;
      gap: 2px;
      text-align: right;
    }

    .logo-brand {
      font-size: 18px;
      font-weight: 800;
      letter-spacing: 0.24em;
      text-transform: uppercase;
      color: #020617;
    }

    .logo-sub {
      font-size: 9px;
      color: #6b7280;
      letter-spacing: 0.12em;
      text-transform: uppercase;
    }

    .main-body {
      flex: 1;
      display: flex;
      flex-direction: column;
      overflow: hidden;
    }

    .screen {
      flex: 1;
      display: none;
      flex-direction: column;
      overflow: hidden;
    }

    .screen.active {
      display: flex;
    }

    .intro-text {
      font-size: 14px;
      color: #4b5563;
      line-height: 1.5;
      margin-top: 6px;
    }

    .intro-text strong {
      color: #111827;
    }

    .centered {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      flex: 1;
      text-align: center;
      padding: 12px 4px 8px;
    }

    .main-btn {
      padding: 11px 20px;
      border-radius: 999px;
      border: none;
      background: #3b82f6;
      color: #f9fafb;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      box-shadow:
        0 0 0 1px rgba(37,99,235,0.9),
        0 8px 22px rgba(59,130,246,0.55);
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }

    .secondary-btn {
      padding: 8px 14px;
      border-radius: 999px;
      border: 1px solid #d1d5db;
      background: #ffffff;
      color: #111827;
      font-size: 13px;
      cursor: pointer;
    }

    .bottom-row {
      margin-top: 8px;
      display: flex;
      justify-content: space-between;
      gap: 8px;
      align-items: center;
    }

    /* –ü—Ä–æ–≥—Ä–µ—Å—Å */

    .progress-wrap {
      margin: 4px 0 8px;
    }

    .progress-label {
      font-size: 11px;
      color: #6b7280;
      margin-bottom: 4px;
      text-transform: uppercase;
      letter-spacing: 0.12em;
    }

    .progress-bar {
      width: 100%;
      height: 6px;
      border-radius: 999px;
      background: #e5e7eb;
      overflow: hidden;
    }

    .progress-fill {
      height: 100%;
      width: 0;
      border-radius: 999px;
      background: linear-gradient(90deg, #3b82f6, #22c55e);
      transition: width 0.3s ease-out;
    }

    /* –í–æ–ø—Ä–æ—Å—ã */

    .question-block {
      flex: 1;
      display: flex;
      flex-direction: column;
      overflow: hidden;
    }

    .question-meta {
      font-size: 12px;
      color: #6b7280;
      margin-bottom: 4px;
    }

    .question-title {
      font-size: 16px;
      font-weight: 600;
      color: #111827;
      margin-bottom: 10px;
    }

    .answers-list {
      flex: 1;
      overflow-y: auto;
      padding-right: 2px;
      padding-bottom: 4px;
    }

    .answer-btn {
      width: 100%;
      text-align: left;
      padding: 9px 10px;
      margin-bottom: 6px;
      border-radius: 14px;
      border: 1px solid #d1d5db;
      background: #ffffff;
      font-size: 14px;
      color: #111827;
      cursor: pointer;
      display: flex;
      align-items: flex-start;
      gap: 8px;
      transition:
        background 0.2s ease-out,
        border-color 0.2s ease-out,
        transform 0.08s ease-out,
        box-shadow 0.2s ease-out;
    }

    .answer-bullet {
      width: 8px;
      height: 8px;
      border-radius: 999px;
      margin-top: 6px;
      background: #d1d5db;
      flex-shrink: 0;
    }

    .answer-text {
      flex: 1;
    }

    .answer-btn:hover {
      border-color: #3b82f6;
      box-shadow: 0 0 0 1px rgba(59,130,246,0.4);
    }

    .answer-btn.selected {
      background: #eff6ff;
      border-color: #2563eb;
      box-shadow:
        0 0 0 1px rgba(37,99,235,0.7),
        0 6px 14px rgba(59,130,246,0.35);
      transform: translateY(-1px);
    }

    .answer-btn.selected .answer-bullet {
      background: #3b82f6;
    }

    .question-footer {
      margin-top: 6px;
      display: flex;
      justify-content: space-between;
      gap: 8px;
      align-items: center;
    }

    .question-hint {
      font-size: 11px;
      color: #6b7280;
    }

    /* –†–µ–∑—É–ª—å—Ç–∞—Ç */

    .result-body {
      flex: 1;
      overflow-y: auto;
      padding-right: 2px;
      padding-bottom: 4px;
    }

    .result-title {
      font-size: 17px;
      font-weight: 600;
      margin-bottom: 8px;
      color: #111827;
    }

    .result-intro {
      font-size: 14px;
      color: #4b5563;
      margin-bottom: 10px;
      line-height: 1.5;
    }

    .zone-block {
      margin-bottom: 10px;
      padding: 8px 10px;
      border-radius: 14px;
      background: #ffffff;
      border: 1px solid #e5e7eb;
    }

    .zone-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 6px;
      margin-bottom: 4px;
    }

    .zone-title {
      font-size: 14px;
      font-weight: 600;
      color: #111827;
    }

    .risk-pill {
      padding: 3px 8px;
      border-radius: 999px;
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 0.09em;
      font-weight: 600;
      cursor: pointer;
    }

    .risk-low {
      background: #dcfce7;
      color: #166534;
      border: 1px solid #16a34a;
    }

    .risk-mid {
      background: #fef3c7;
      color: #92400e;
      border: 1px solid #f59e0b;
    }

    .risk-high {
      background: #fee2e2;
      color: #991b1b;
      border: 1px solid #ef4444;
    }

    .zone-text {
      font-size: 13px;
      color: #4b5563;
      line-height: 1.45;
    }

    .zone-text strong {
      color: #111827;
    }

    .result-warning {
      margin-top: 4px;
      font-size: 13px;
      color: #b91c1c;
    }

    /* –ë–ª–æ–∫ –∫—Ä–µ—Å–µ–ª */

    .chairs-section {
      margin-top: 12px;
      padding-top: 8px;
      border-top: 1px solid #e5e7eb;
      display: none;
    }

    .chairs-title {
      font-size: 15px;
      font-weight: 600;
      margin-bottom: 6px;
      color: #111827;
    }

    .chairs-sub {
      font-size: 13px;
      color: #4b5563;
      margin-bottom: 8px;
    }

    .carousel {
      position: relative;
      border-radius: 16px;
      background: #ffffff;
      border: 1px solid #e5e7eb;
      padding: 10px 10px 10px;
      overflow: hidden;
    }

    .carousel-track {
      display: flex;
      transition: transform 0.3s ease-out;
    }

    .chair-card {
      min-width: 100%;
      padding-right: 4px;
    }

    .chair-photo {
      width: 100%;
      height: 140px;
      border-radius: 14px;
      background: radial-gradient(circle at 20% 0, #dbeafe 0, #bfdbfe 40%, #93c5fd 100%);
      display: flex;
      align-items: flex-end;
      justify-content: flex-start;
      padding: 10px 12px;
      color: #111827;
      font-weight: 600;
      font-size: 14px;
    }

    .chair-tag {
      font-size: 11px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.12em;
      color: #1d4ed8;
      margin-bottom: 2px;
    }

    .chair-name {
      font-size: 14px;
      font-weight: 600;
      color: #111827;
      margin-bottom: 3px;
    }

    .chair-desc {
      font-size: 13px;
      color: #4b5563;
      line-height: 1.4;
      margin-bottom: 4px;
    }

    .carousel-nav {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 6px;
      gap: 8px;
    }

    .carousel-btn {
      width: 26px;
      height: 26px;
      border-radius: 999px;
      border: 1px solid #d1d5db;
      background: #ffffff;
      cursor: pointer;
      font-size: 15px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #111827;
    }

    .carousel-dots {
      display: flex;
      gap: 4px;
      justify-content: center;
      flex: 1;
    }

    .carousel-dot {
      width: 6px;
      height: 6px;
      border-radius: 999px;
      background: #e5e7eb;
    }

    .carousel-dot.active {
      background: #3b82f6;
    }

    .chairs-cta {
      margin-top: 8px;
      font-size: 13px;
      color: #4b5563;
      line-height: 1.5;
    }

    .chairs-cta a {
      color: #1d4ed8;
      text-decoration: none;
      font-weight: 500;
    }

    .chairs-cta a:hover {
      text-decoration: underline;
    }

    .cta-buttons {
      margin-top: 6px;
      display: flex;
      gap: 6px;
      flex-wrap: wrap;
    }

    .cta-btn {
      padding: 7px 10px;
      border-radius: 999px;
      border: 1px solid #d1d5db;
      background: #ffffff;
      font-size: 13px;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      text-decoration: none;
      color: #111827;
      cursor: pointer;
    }

    .cta-btn.primary {
      background: #3b82f6;
      color: #f9fafb;
      border-color: #2563eb;
      box-shadow:
        0 0 0 1px rgba(37,99,235,0.9),
        0 6px 16px rgba(59,130,246,0.55);
    }

    /* –ú–æ–¥–∞–ª–∫–∏ */

    .modal-backdrop {
      position: fixed;
      inset: 0;
      background: rgba(15,23,42,0.25);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 30;
    }

    .modal-backdrop.hidden {
      display: none;
    }

    .modal-inner {
      width: 100%;
      max-width: 360px;
      background: #f9fafb;
      border-radius: 20px;
      padding: 18px 16px 12px;
      box-shadow:
        0 18px 40px rgba(148,163,184,0.9),
        0 0 0 1px rgba(191,219,254,0.9);
      border: 1px solid #e5e7eb;
    }

    .modal-title {
      font-size: 16px;
      font-weight: 600;
      margin-bottom: 6px;
      color: #111827;
    }

    .modal-text {
      font-size: 14px;
      color: #4b5563;
      line-height: 1.5;
      margin-bottom: 10px;
    }

    .modal-actions {
      display: flex;
      justify-content: flex-end;
      gap: 8px;
      flex-wrap: wrap;
    }

    .fade-enter {
      animation: fadeUp 0.22s ease-out;
    }

    @keyframes fadeUp {
      from {
        opacity: 0;
        transform: translateY(4px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    @media (max-width: 420px) {
      .card {
        border-radius: 16px;
        padding: 14px 12px 10px;
      }
      .logo-brand {
        font-size: 16px;
      }
    }

    @media (orientation: landscape) and (max-height: 480px) {
      .card {
        transform: scale(0.9);
        transform-origin: top center;
      }
    }
  </style>
</head>
<body>
  <div class="shell">
    <div class="card">
      <div class="header">
        <div>
          <div class="badge">
            <span class="badge-dot"></span>
            METTA ‚Ä¢ Posture
          </div>
          <h1>–¢–µ—Å—Ç –ø–æ—Å–∞–¥–∫–∏</h1>
          <div class="subtitle">
            7 –±—ã—Å—Ç—Ä—ã—Ö –≤–æ–ø—Ä–æ—Å–æ–≤ –ø—Ä–æ —Ç–æ, –∫–∞–∫ —Ç—ã –æ–±—ã—á–Ω–æ —Å–∏–¥–∏—à—å –∑–∞ –∫–æ–º–ø—å—é—Ç–µ—Ä–æ–º.
          </div>
        </div>
        <div class="logo">
          <div class="logo-brand">METTA</div>
          <div class="logo-sub">ERGONOMIC CHAIRS</div>
        </div>
      </div>

      <div class="main-body">
        <!-- –≠–∫—Ä–∞–Ω 1 ‚Äî –∏–Ω—Ç—Ä–æ -->
        <div id="introScreen" class="screen active">
          <div class="centered">
            <div class="intro-text">
              <strong>–°–µ–π—á–∞—Å –ø—Ä–æ–≤–µ—Ä–∏–º —Ç–≤–æ—é –ø–æ—Å–∞–¥–∫—É.</strong><br><br>
              –û—Ç–≤–µ—á–∞–π —á–µ—Å—Ç–Ω–æ ‚Äî —ç—Ç–æ —Ç–æ–ª—å–∫–æ –¥–ª—è —Ç–µ–±—è. –ú—ã –Ω–µ —Å—Ç–∞–≤–∏–º –¥–∏–∞–≥–Ω–æ–∑—ã,
              –∞ –¥–∞—ë–º –ø–æ–Ω—è—Ç–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏: —á—Ç–æ –∏–∑–º–µ–Ω–∏—Ç—å –≤ –ø–æ—Å–∞–¥–∫–µ –∏ –ø–æ—á–µ–º—É
              —Ç–µ–ª—É –æ—Ç —ç—Ç–æ–≥–æ —Å—Ç–∞–Ω–µ—Ç –ª–µ–≥—á–µ.
            </div>
            <div style="margin-top: 16px;">
              <button id="startTestBtn" class="main-btn">
                <span>üßç‚Äç‚ôÄÔ∏è</span>
                <span>–ü—Ä–æ–π—Ç–∏ —Ç–µ—Å—Ç</span>
              </button>
            </div>
          </div>
        </div>

        <!-- –≠–∫—Ä–∞–Ω 2 ‚Äî –≤–æ–ø—Ä–æ—Å—ã -->
        <div id="questionScreen" class="screen">
          <div class="progress-wrap">
            <div class="progress-label" id="progressLabel">–í–æ–ø—Ä–æ—Å 1 –∏–∑ 7</div>
            <div class="progress-bar">
              <div id="progressFill" class="progress-fill"></div>
            </div>
          </div>

          <div class="question-block">
            <div class="question-meta" id="questionMeta"></div>
            <div class="question-title" id="questionTitle"></div>
            <div class="answers-list" id="answersList"></div>
            <div class="question-footer">
              <div class="question-hint" id="questionHint">
                –í—ã–±–µ—Ä–∏ –≤–∞—Ä–∏–∞–Ω—Ç, –∫–æ—Ç–æ—Ä—ã–π —á–∞—â–µ –≤—Å–µ–≥–æ –ø—Ä–æ —Ç–µ–±—è.
              </div>
              <button id="nextBtn" class="secondary-btn">–î–∞–ª—å—à–µ</button>
            </div>
          </div>
        </div>

        <!-- –≠–∫—Ä–∞–Ω 3 ‚Äî —Ä–µ–∑—É–ª—å—Ç–∞—Ç -->
        <div id="resultScreen" class="screen">
          <div class="result-body" id="resultBody"></div>
          <div class="bottom-row">
            <button id="restartBtn" class="secondary-btn">–ü—Ä–æ–π—Ç–∏ –µ—â—ë —Ä–∞–∑</button>
            <button id="showChairsBtn" class="main-btn">
              <span>üí∫</span><span>–ü–æ–¥–±–æ—Ä –∫—Ä–µ—Å–ª–∞</span>
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- –ú–æ–¥–∞–ª–∫–∞ —Å –≤–æ–ø—Ä–æ—Å–æ–º –ø—Ä–æ –∫—Ä–µ—Å–ª–∞ -->
  <div id="chairsModal" class="modal-backdrop hidden">
    <div class="modal-inner">
      <div class="modal-title">–ü–æ–¥–±–æ—Ä –∫—Ä–µ—Å–ª–∞ METTA</div>
      <div class="modal-text">
        –ü–æ –æ—Ç–≤–µ—Ç–∞–º –≤–∏–¥–Ω–æ, –∫–∞–∫–∏–µ –∑–æ–Ω—ã —Ç–µ–ª–∞ –ø–µ—Ä–µ–≥—Ä—É–∂–µ–Ω—ã –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ.
        –•–æ—á–µ—à—å, –ø–æ–∫–∞–∂—É –ø—Ä–∏–º–µ—Ä—ã –∫—Ä–µ—Å–µ–ª –∏–∑ –ª–∏–Ω–µ–π–∫–∏ Samurai –Ω–∞ —Å–∞–π—Ç–µ
        <strong>samurai.wr-office.ru</strong>, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–º–æ–≥—É—Ç —Ä–∞–∑–≥—Ä—É–∑–∏—Ç—å —Å–ø–∏–Ω—É –∏ —à–µ—é?
      </div>
      <div class="modal-actions">
        <button id="chairsNoBtn" class="secondary-btn">–ü–æ–∫–∞ –Ω–µ—Ç</button>
        <button id="chairsYesBtn" class="main-btn">–î–∞, –ø–æ–∫–∞–∑–∞—Ç—å</button>
      </div>
    </div>
  </div>

  <script>
    // --- –ê—É–¥–∏–æ –¥–ª—è –≤—ã–±–æ—Ä–∞ –æ—Ç–≤–µ—Ç–æ–≤ ---
    let audioCtx = null;

    function ensureAudioCtx() {
      if (!audioCtx) {
        audioCtx = new (window.AudioContext || window.webkitAudioContext)();
      }
      if (audioCtx.state === "suspended") {
        audioCtx.resume();
      }
    }

    function playClickSound() {
      try {
        ensureAudioCtx();
        const now = audioCtx.currentTime;
        const osc = audioCtx.createOscillator();
        const gain = audioCtx.createGain();
        osc.type = "sine";
        osc.frequency.setValueAtTime(520, now);
        osc.connect(gain);
        gain.connect(audioCtx.destination);
        gain.gain.setValueAtTime(0.0001, now);
        gain.gain.exponentialRampToValueAtTime(0.14, now + 0.01);
        gain.gain.exponentialRampToValueAtTime(0.0001, now + 0.13);
        osc.start(now);
        osc.stop(now + 0.15);
      } catch (e) {}
    }

    function vibrate(pattern = 15) {
      try {
        if (navigator.vibrate) {
          navigator.vibrate(pattern);
        }
      } catch (e) {}
    }

    function tactileTap() {
      playClickSound();
      vibrate(20);
    }

    // --- –î–∞–Ω–Ω—ã–µ –≤–æ–ø—Ä–æ—Å–æ–≤ ---
    const questions = [
      {
        id: "q1",
        block: "–ü–æ—è—Å–Ω–∏—Ü–∞ –∏ —Ç–∞–∑",
        zone: "lumbar",
        text: "–ö–∞–∫ —Ç—ã –æ–±—ã—á–Ω–æ —Å–∏–¥–∏—à—å –Ω–∞ —Å—Ç—É–ª–µ/–∫—Ä–µ—Å–ª–µ?",
        options: [
          {
            text: "–°–∞–∂—É—Å—å –Ω–∞ –∫—Ä–∞–π —Å–∏–¥–µ–Ω—å—è, —Å–ø–∏–Ω–∞ –ø–æ—á—Ç–∏ –Ω–µ –∫–∞—Å–∞–µ—Ç—Å—è —Å–ø–∏–Ω–∫–∏.",
            scores: { lumbar: 2 }
          },
          {
            text: "–°–∏–∂—É –≥–ª—É–±–æ–∫–æ, –Ω–æ –ø–æ—è—Å–Ω–∏—Ü–∞ –Ω–µ —É–ø–∏—Ä–∞–µ—Ç—Å—è –≤ —Å–ø–∏–Ω–∫—É.",
            scores: { lumbar: 1 }
          },
          {
            text: "–°–∏–∂—É –≥–ª—É–±–æ–∫–æ, –ø–æ—è—Å–Ω–∏—Ü–∞ —Ö–æ—Ä–æ—à–æ –∫–∞—Å–∞–µ—Ç—Å—è —Å–ø–∏–Ω–∫–∏ / –≤–∞–ª–∏–∫–∞.",
            scores: { lumbar: 0 }
          },
          {
            text: "–ü–æ—Å—Ç–æ—è–Ω–Ω–æ –¥–≤–∏–≥–∞—é—Å—å ‚Äî —Ç–æ –Ω–∞ –∫—Ä–∞—é, —Ç–æ –≥–ª—É–±–æ–∫–æ.",
            scores: { lumbar: 1 }
          }
        ]
      },
      {
        id: "q2",
        block: "–°–ø–∏–Ω–∞ –∏ –≥—Ä—É–¥–Ω–æ–π –æ—Ç–¥–µ–ª",
        zone: "lumbar",
        text: "–ö–∞–∫ —á–∞—â–µ –≤—Å–µ–≥–æ –≤—ã–≥–ª—è–¥–∏—Ç —Ç–≤–æ—è —Å–ø–∏–Ω–∞, –∫–æ–≥–¥–∞ —Ä–∞–±–æ—Ç–∞–µ—à—å?",
        options: [
          {
            text: "–°–∏–ª—å–Ω–æ —Å—É—Ç—É–ª—é—Å—å, –ø–ª–µ—á–∏ –≤–ø–µ—Ä—ë–¥.",
            scores: { lumbar: 2 }
          },
          {
            text: "–ß—É—Ç—å-—á—É—Ç—å —Å—É—Ç—É–ª—é—Å—å, –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ –∑–∞–º–µ—á–∞—é —ç—Ç–æ.",
            scores: { lumbar: 1 }
          },
          {
            text: "–°–∏–∂—É –±–æ–ª–µ–µ-–º–µ–Ω–µ–µ —Ä–æ–≤–Ω–æ, –Ω–æ –±—ã—Å—Ç—Ä–æ —É—Å—Ç–∞—é.",
            scores: { lumbar: 1 }
          },
          {
            text: "–°–ø–∏–Ω–∞ —Ä–æ–≤–Ω–∞—è, –∫–∞–∂–µ—Ç—Å—è, —á—Ç–æ –¥–µ—Ä–∂—É –æ—Å–∞–Ω–∫—É –±–µ–∑ —Å–∏–ª—å–Ω–æ–≥–æ –Ω–∞–ø—Ä—è–∂–µ–Ω–∏—è.",
            scores: { lumbar: 0 }
          }
        ]
      },
      {
        id: "q3",
        block: "–ì–æ–ª–æ–≤–∞ –∏ —à–µ—è",
        zone: "neck",
        text: "–ì–¥–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è —Ç–≤–æ—è –≥–æ–ª–æ–≤–∞ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –∫–æ—Ä–ø—É—Å–∞, –∫–æ–≥–¥–∞ —Å–º–æ—Ç—Ä–∏—à—å –≤ —ç–∫—Ä–∞–Ω?",
        options: [
          {
            text: "–®–µ—è –≤—ã—Ç—è–Ω—É—Ç–∞ –≤–ø–µ—Ä—ë–¥, –∫–∞–∫ –±—É–¥—Ç–æ —Ç—è–Ω—É—Å—å –∫ —ç–∫—Ä–∞–Ω—É.",
            scores: { neck: 2 }
          },
          {
            text: "–ü–æ–¥–±–æ—Ä–æ–¥–æ–∫ —á–∞—Å—Ç–æ –æ–ø—É—Å–∫–∞–µ—Ç—Å—è –≤–Ω–∏–∑, –≥–æ–ª–æ–≤–∞ –Ω–µ–º–Ω–æ–≥–æ –Ω–∞–∫–ª–æ–Ω–µ–Ω–∞.",
            scores: { neck: 1 }
          },
          {
            text: "–ì–æ–ª–æ–≤–∞ –ø—Ä–∏–º–µ—Ä–Ω–æ –Ω–∞–¥ –ø–ª–µ—á–∞–º–∏, –±–µ–∑ —Å–∏–ª—å–Ω–æ–≥–æ –Ω–∞–∫–ª–æ–Ω–∞.",
            scores: { neck: 0 }
          },
          {
            text: "–ß–∞—Å—Ç–æ –Ω–∞–∫–ª–æ–Ω—è—é –≥–æ–ª–æ–≤—É –Ω–∞–±–æ–∫ / –æ–ø–∏—Ä–∞—é—Å—å —â–µ–∫–æ–π –Ω–∞ —Ä—É–∫—É.",
            scores: { neck: 1 }
          }
        ]
      },
      {
        id: "q4",
        block: "–û–ø–æ—Ä–∞ –¥–ª—è —à–µ–∏",
        zone: "neck",
        text: "–ï—Å—Ç—å –ª–∏ —É —Ç–µ–±—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –≥–æ–ª–æ–≤—ã –∏–ª–∏ —à–µ–∏?",
        options: [
          {
            text: "–ü–æ–¥–≥–æ–ª–æ–≤–Ω–∏–∫ –∫—Ä–µ—Å–ª–∞ ‚Äî –≤—Ä–µ–º—è –æ—Ç –≤—Ä–µ–º–µ–Ω–∏ –æ–ø–∏—Ä–∞—é—Å—å.",
            scores: { neck: 0 }
          },
          {
            text: "–ü–æ–¥—É—à–∫–∞/–≤–∞–ª–∏–∫ –ø–æ–¥ —à–µ–µ–π.",
            scores: { neck: 1 }
          },
          {
            text: "–ù–∏–∫–∞–∫–æ–π –ø–æ–¥–¥–µ—Ä–∂–∫–∏, –≤—Å—è –Ω–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ –º—ã—à—Ü—ã.",
            scores: { neck: 2 }
          },
          {
            text: "–ò–Ω–æ–≥–¥–∞ –æ—Ç–∫–∏–¥—ã–≤–∞—é—Å—å –Ω–∞–∑–∞–¥ –∏ –æ–ø–∏—Ä–∞—é—Å—å, –Ω–æ —Ä–µ–¥–∫–æ.",
            scores: { neck: 1 }
          }
        ]
      },
      {
        id: "q5",
        block: "–û—â—É—â–µ–Ω–∏—è –≤ —à–µ–µ –∏ –ø–ª–µ—á–∞—Ö",
        zone: "neck",
        text: "–ß—Ç–æ —á–∞—â–µ –≤—Å–µ–≥–æ —á—É–≤—Å—Ç–≤—É–µ—à—å –≤ –æ–±–ª–∞—Å—Ç–∏ —à–µ–∏ –∏ –ø–ª–µ—á –∫ –∫–æ–Ω—Ü—É –¥–Ω—è?",
        options: [
          {
            text: "–¢—è–∂–µ—Å—Ç—å –≤ –≥–æ–ª–æ–≤–µ, –Ω–∞–ø—Ä—è–∂–µ–Ω–∏–µ –≤ —à–µ–µ.",
            scores: { neck: 2 }
          },
          {
            text: "–ë–æ–ª—è—Ç –ø–ª–µ—á–∏ / —Ç—Ä–∞–ø–µ—Ü–∏–∏.",
            scores: { neck: 2 }
          },
          {
            text: "–£—Å—Ç–∞–ª–æ—Å—Ç—å, –Ω–æ –±–µ–∑ —è—Ä–∫–æ–π –±–æ–ª–∏.",
            scores: { neck: 1 }
          },
          {
            text: "–û—Å–æ–±—ã—Ö –æ—â—É—â–µ–Ω–∏–π –Ω–µ—Ç.",
            scores: { neck: 0 }
          }
        ]
      },
      {
        id: "q6",
        block: "–ù–æ–≥–∏ –∏ —Å—Ç–æ–ø—ã",
        zone: "legs",
        text: "–ö–∞–∫ –æ–±—ã—á–Ω–æ —Å—Ç–æ—è—Ç –Ω–æ–≥–∏, –∫–æ–≥–¥–∞ —Ç—ã —Ä–∞–±–æ—Ç–∞–µ—à—å?",
        options: [
          {
            text: "–ù–æ–≥–∞ –Ω–∞ –Ω–æ–≥—É / –ø–æ–¥–≤–æ—Ä–∞—á–∏–≤–∞—é —Å—Ç—É–ø–Ω—é –ø–æ–¥ —Å–µ–±—è.",
            scores: { legs: 2 }
          },
          {
            text: "–°—Ç—É–ø–Ω–∏ –Ω–µ –¥–æ—Å—Ç–∞—é—Ç –¥–æ –ø–æ–ª–∞ / –≤–∏—Å—è—Ç.",
            scores: { legs: 2 }
          },
          {
            text: "–°—Ç—É–ø–Ω–∏ —Å—Ç–æ—è—Ç –Ω–∞ –ø–æ–ª—É, –Ω–æ –æ–¥–Ω–∞ –Ω–æ–≥–∞ —É—Ö–æ–¥–∏—Ç –ø–æ–¥ –∫—Ä–µ—Å–ª–æ –∏–ª–∏ –Ω–∞ –Ω–æ—Å–æ–∫.",
            scores: { legs: 1 }
          },
          {
            text: "–î–≤–µ —Å—Ç–æ–ø—ã –ø–æ–ª–Ω–æ—Å—Ç—å—é –Ω–∞ –ø–æ–ª—É –∏–ª–∏ –ø–æ–¥—Å—Ç–∞–≤–∫–µ, –ø—Ä–∏–º–µ—Ä–Ω–æ –Ω–∞ —à–∏—Ä–∏–Ω–µ –ø–ª–µ—á.",
            scores: { legs: 0 }
          }
        ]
      },
      {
        id: "q7",
        block: "–û–±—â–µ–µ —Å–∞–º–æ—á—É–≤—Å—Ç–≤–∏–µ",
        zone: "general",
        text: "–ß—Ç–æ —Å –æ—â—É—â–µ–Ω–∏—è–º–∏ –≤ —Ç–µ–ª–µ –ø–æ—Å–ª–µ 2‚Äì3 —á–∞—Å–æ–≤ —Ä–∞–±–æ—Ç—ã?",
        options: [
          {
            text: "–¢—è–Ω—É—â–∞—è –±–æ–ª—å –≤ –ø–æ—è—Å–Ω–∏—Ü–µ.",
            scores: { lumbar: 2, general: 1 }
          },
          {
            text: "–£—Å—Ç–∞–ª–æ—Å—Ç—å –≤ —à–µ–µ –∏ –ø–ª–µ—á–∞—Ö.",
            scores: { neck: 2, general: 1 }
          },
          {
            text: "–¢—è–∂–µ—Å—Ç—å –≤ –Ω–æ–≥–∞—Ö / –æ–Ω–µ–º–µ–Ω–∏–µ.",
            scores: { legs: 2, general: 1 }
          },
          {
            text: "–ë—ã—Å—Ç—Ä–æ —É—Å—Ç–∞—é, –Ω–æ –Ω–µ –ø–æ–Ω–∏–º–∞—é –æ—Ç–∫—É–¥–∞.",
            scores: { general: 2 }
          },
          {
            text: "–ß—É–≤—Å—Ç–≤—É—é —Å–µ–±—è –Ω–æ—Ä–º–∞–ª—å–Ω–æ.",
            scores: { general: 0 }
          }
        ]
      }
    ];

    const introScreen = document.getElementById("introScreen");
    const questionScreen = document.getElementById("questionScreen");
    const resultScreen = document.getElementById("resultScreen");

    const startTestBtn = document.getElementById("startTestBtn");
    const progressLabel = document.getElementById("progressLabel");
    const progressFill = document.getElementById("progressFill");
    const questionMeta = document.getElementById("questionMeta");
    const questionTitle = document.getElementById("questionTitle");
    const answersList = document.getElementById("answersList");
    const nextBtn = document.getElementById("nextBtn");
    const resultBody = document.getElementById("resultBody");
    const restartBtn = document.getElementById("restartBtn");
    const showChairsBtn = document.getElementById("showChairsBtn");

    const chairsModal = document.getElementById("chairsModal");
    const chairsYesBtn = document.getElementById("chairsYesBtn");
    const chairsNoBtn = document.getElementById("chairsNoBtn");

    let currentIndex = 0;
    let selectedOptionIndex = null;
    const answers = {};  // questionId -> optionIndex

    function showScreen(el) {
      [introScreen, questionScreen, resultScreen].forEach(s => {
        s.classList.remove("active");
      });
      el.classList.add("active");
    }

    function renderQuestion() {
      const total = questions.length;
      const q = questions[currentIndex];

      progressLabel.textContent = `–í–æ–ø—Ä–æ—Å ${currentIndex + 1} –∏–∑ ${total}`;
      const pct = ((currentIndex) / total) * 100;
      progressFill.style.width = `${pct}%`;

      questionMeta.textContent = q.block;
      questionTitle.textContent = q.text;
      answersList.innerHTML = "";
      selectedOptionIndex = answers[q.id] != null ? answers[q.id] : null;

      q.options.forEach((opt, idx) => {
        const btn = document.createElement("button");
        btn.className = "answer-btn fade-enter";
        if (selectedOptionIndex === idx) {
          btn.classList.add("selected");
        }
        btn.dataset.index = idx;

        const dot = document.createElement("div");
        dot.className = "answer-bullet";

        const span = document.createElement("div");
        span.className = "answer-text";
        span.textContent = opt.text;

        btn.appendChild(dot);
        btn.appendChild(span);

        btn.addEventListener("click", () => {
          tactileTap();
          selectedOptionIndex = idx;
          answers[q.id] = idx;
          document.querySelectorAll(".answer-btn").forEach(b => b.classList.remove("selected"));
          btn.classList.add("selected");
        });

        answersList.appendChild(btn);
      });

      nextBtn.textContent = currentIndex === total - 1 ? "–ü–æ–∫–∞–∑–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç" : "–î–∞–ª—å—à–µ";
    }

    function goNextQuestion() {
      const q = questions[currentIndex];
      if (answers[q.id] == null) {
        // –º—è–≥–∫–æ–µ –ø–æ–¥—Ç–∞–ª–∫–∏–≤–∞–Ω–∏–µ
        questionHint.textContent = "–í—ã–±–µ—Ä–∏ –≤–∞—Ä–∏–∞–Ω—Ç, –∫–æ—Ç–æ—Ä—ã–π –±–ª–∏–∂–µ –≤—Å–µ–≥–æ –∫ —Ç–≤–æ–µ–π –æ–±—ã—á–Ω–æ–π –ø–æ—Å–∞–¥–∫–µ.";
        questionHint.style.color = "#b91c1c";
        setTimeout(() => {
          questionHint.style.color = "#6b7280";
        }, 1200);
        return;
      }

      if (currentIndex < questions.length - 1) {
        currentIndex++;
        renderQuestion();
      } else {
        showResult();
      }
    }

    function getRiskLevel(score) {
      if (score <= 1) return "low";
      if (score <= 3) return "mid";
      return "high";
    }

    function riskLabel(level) {
      if (level === "low") return "–Ω–∏–∑–∫–∏–π —Ä–∏—Å–∫";
      if (level === "mid") return "—Å—Ä–µ–¥–Ω–∏–π —Ä–∏—Å–∫";
      return "–ø–æ–≤—ã—à–µ–Ω–Ω—ã–π —Ä–∏—Å–∫";
    }

    function riskSentence(level, zoneName) {
      if (level === "low") {
        return `${zoneName}: –≤ —Ü–µ–ª–æ–º –ø–æ—Å–∞–¥–∫–∞ –¥–æ–≤–æ–ª—å–Ω–æ —â–∞–¥—è—â–∞—è, –≤–∞–∂–Ω—ã—Ö —Ç—Ä–µ–≤–æ–∂–Ω—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤ —Å–µ–π—á–∞—Å –Ω–µ–º–Ω–æ–≥–æ.`;
      } else if (level === "mid") {
        return `${zoneName}: —á–∞—Å—Ç—å –ø–æ–∑–∏—Ü–∏–π —Ç–µ–ª–∞ –¥–∞—ë—Ç –ª–∏—à–Ω—é—é –Ω–∞–≥—Ä—É–∑–∫—É, –Ω–æ —Å–∏—Ç—É–∞—Ü–∏—é –µ—â—ë –º–æ–∂–Ω–æ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å –ø—Ä–æ—Å—Ç—ã–º–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏ –ø–æ—Å–∞–¥–∫–∏.`;
      } else {
        return `${zoneName}: –ø–æ –æ—Ç–≤–µ—Ç–∞–º –≤–∏–¥–Ω–æ —É—Å—Ç–æ–π—á–∏–≤—É—é –ø–µ—Ä–µ–≥—Ä—É–∑–∫—É ‚Äî –µ—Å–ª–∏ –Ω–∏—á–µ–≥–æ –Ω–µ –º–µ–Ω—è—Ç—å, —Ä–∏—Å–∫ —Ö—Ä–æ–Ω–∏—á–µ—Å–∫–æ–≥–æ –Ω–∞–ø—Ä—è–∂–µ–Ω–∏—è –∏ –±–æ–ª–∏ –≤—ã—à–µ —Å—Ä–µ–¥–Ω–µ–≥–æ.`;
      }
    }

    function lumberText(level) {
      if (level === "low") {
        return "–¢—ã —Ö–æ—Ç—è –±—ã —á–∞—Å—Ç—å –≤—Ä–µ–º–µ–Ω–∏ –¥–∞—ë—à—å –ø–æ—è—Å–Ω–∏—Ü–µ –æ–ø–æ—Ä—É —Å–ø–∏–Ω–∫–æ–π –∫—Ä–µ—Å–ª–∞. –≠—Ç–æ —Å–Ω–∏–∂–∞–µ—Ç –Ω–∞–≥—Ä—É–∑–∫—É –Ω–∞ –º—ã—à—Ü—ã –∏ –¥–∏—Å–∫–∏ –ø–æ—è—Å–Ω–∏—á–Ω–æ–≥–æ –æ—Ç–¥–µ–ª–∞.";
      }
      if (level === "mid") {
        return "–ò–Ω–æ–≥–¥–∞ –ø–æ—è—Å–Ω–∏—Ü–∞ –æ–ø–∏—Ä–∞–µ—Ç—Å—è –Ω–∞ —Å–ø–∏–Ω–∫—É, –Ω–æ —á–∞—Å—Ç–æ –∫–æ—Ä–ø—É—Å –¥–µ—Ä–∂–∞—Ç –º—ã—à—Ü—ã. –ò–∑-–∑–∞ —ç—Ç–æ–≥–æ –æ–Ω–∏ –±—ã—Å—Ç—Ä–µ–µ —É—Å—Ç–∞—é—Ç, –∞ –∫ –≤–µ—á–µ—Ä—É –º–æ–∂–µ—Ç –ø–æ—è–≤–ª—è—Ç—å—Å—è —Ç—è–Ω—É—â–∞—è –±–æ–ª—å –≤–Ω–∏–∑—É —Å–ø–∏–Ω—ã.";
      }
      return "–ß–∞—Å—Ç–∞—è –ø–æ—Å–∞–¥–∫–∞ –Ω–∞ –∫—Ä–∞—é —Å–∏–¥–µ–Ω—å—è –∏–ª–∏ –±–µ–∑ –ø–ª–æ—Ç–Ω–æ–≥–æ –∫–æ–Ω—Ç–∞–∫—Ç–∞ –ø–æ—è—Å–Ω–∏—Ü—ã —Å–æ —Å–ø–∏–Ω–∫–æ–π –∑–∞—Å—Ç–∞–≤–ª—è–µ—Ç –º—ã—à—Ü—ã –ø–æ—è—Å–Ω–∏—Ü—ã –ø–æ—Å—Ç–æ—è–Ω–Ω–æ ¬´–¥–µ—Ä–∂–∞—Ç—å¬ª –∫–æ—Ä–ø—É—Å. –≠—Ç–æ —Ç–∏–ø–∏—á–Ω—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π —Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –±–æ–ª–∏ –≤ –ø–æ—è—Å–Ω–∏—Ü–µ.";
    }

    function neckText(level) {
      if (level === "low") {
        return "–ü–æ–ª–æ–∂–µ–Ω–∏–µ –≥–æ–ª–æ–≤—ã –±–ª–∏–∑–∫–æ –∫ –Ω–µ–π—Ç—Ä–∞–ª—å–Ω–æ–º—É: –≥–æ–ª–æ–≤–∞ –Ω–µ —Å–∏–ª—å–Ω–æ —É—Ö–æ–¥–∏—Ç –≤–ø–µ—Ä—ë–¥, —à–µ—è –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ –ø–æ–ª—É—á–∞–µ—Ç –æ–ø–æ—Ä—É.";
      }
      if (level === "mid") {
        return "–ì–æ–ª–æ–≤–∞ –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ —Å–º–µ—â–∞–µ—Ç—Å—è –≤–ø–µ—Ä—ë–¥ –∏–ª–∏ –≤–Ω–∏–∑, –∞ —à–µ—è –Ω–µ –≤—Å–µ–≥–¥–∞ –ø–æ–ª—É—á–∞–µ—Ç –æ–ø–æ—Ä—É. –≠—Ç–æ –¥–∞—ë—Ç —Ñ–æ–Ω–æ–≤–æ–µ –Ω–∞–ø—Ä—è–∂–µ–Ω–∏–µ –º—ã—à—Ü –∏ —É—Å—Ç–∞–ª–æ—Å—Ç—å –∫ –≤–µ—á–µ—Ä—É.";
      }
      return "–ì–æ–ª–æ–≤–∞ —Å—Ç–∞–±–∏–ª—å–Ω–æ —É—Ö–æ–¥–∏—Ç –≤–ø–µ—Ä—ë–¥ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –∫–æ—Ä–ø—É—Å–∞, –∞ —à–µ—è —Ä–µ–¥–∫–æ –æ–ø–∏—Ä–∞–µ—Ç—Å—è –Ω–∞ –ø–æ–¥–≥–æ–ª–æ–≤–Ω–∏–∫/—Å–ø–∏–Ω–∫—É. –≠—Ç–æ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –Ω–∞–≥—Ä—É–∑–∫—É –Ω–∞ —à–µ–π–Ω—ã–µ –ø–æ–∑–≤–æ–Ω–∫–∏ –∏ –º—ã—à—Ü—ã, –æ—Ç—Å—é–¥–∞ ‚Äî —Ç—è–∂–µ—Å—Ç—å –≤ –≥–æ–ª–æ–≤–µ, –∑–∞–∂–∏–º—ã –≤ —à–µ–µ –∏ –ø–ª–µ—á–∞—Ö.";
    }

    function legsText(level) {
      if (level === "low") {
        return "–°—Ç–æ–ø—ã —á–∞—â–µ –≤—Å–µ–≥–æ —Å—Ç–æ—è—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ: –Ω–∞ –ø–æ–ª—É –∏–ª–∏ –ø–æ–¥—Å—Ç–∞–≤–∫–µ, —á—Ç–æ –ø–æ–º–æ–≥–∞–µ—Ç –∫—Ä–æ–≤–æ–æ–±—Ä–∞—â–µ–Ω–∏—é –≤ –Ω–æ–≥–∞—Ö.";
      }
      if (level === "mid") {
        return "–ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ –Ω–æ–≥–∏ —É–µ–∑–∂–∞—é—Ç –ø–æ–¥ –∫—Ä–µ—Å–ª–æ –∏–ª–∏ –Ω–∞ –Ω–æ—Å–æ–∫. –≠—Ç–æ –¥–µ–ª–∞–µ—Ç –ø–æ—Å–∞–¥–∫—É –º–µ–Ω–µ–µ —É—Å—Ç–æ–π—á–∏–≤–æ–π –∏ –º–æ–∂–µ—Ç –¥–∞–≤–∞—Ç—å –æ—â—É—â–µ–Ω–∏–µ ¬´–∑–∞—Å—Ç–æ–π–Ω–æ—Å—Ç–∏¬ª –≤ –Ω–æ–≥–∞—Ö.";
      }
      return "–ü–æ–∑–∞ ¬´–Ω–æ–≥–∞ –Ω–∞ –Ω–æ–≥—É¬ª, –ø–æ–¥–≤–æ—Ä–∞—á–∏–≤–∞–Ω–∏–µ —Å—Ç—É–ø–Ω–∏ –ø–æ–¥ —Å–µ–±—è –∏–ª–∏ –≤–∏—Å—è—â–∏–µ —Å—Ç–æ–ø—ã –Ω–∞—Ä—É—à–∞—é—Ç –∫—Ä–æ–≤–æ–æ–±—Ä–∞—â–µ–Ω–∏–µ –∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–∞–≥—Ä—É–∑–∫–∏. –ò–∑-–∑–∞ —ç—Ç–æ–≥–æ —á–∞—â–µ –ø–æ—è–≤–ª—è—é—Ç—Å—è —Ç—è–∂–µ—Å—Ç—å, –æ–Ω–µ–º–µ–Ω–∏–µ –∏ —É—Å—Ç–∞–ª–æ—Å—Ç—å –≤ –Ω–æ–≥–∞—Ö –∫ –∫–æ–Ω—Ü—É –¥–Ω—è.";
    }

    function generalText(level) {
      if (level === "low") {
        return "–û–±—â–µ–µ —Å–∞–º–æ—á—É–≤—Å—Ç–≤–∏–µ –ø–æ—Å–ª–µ —Ä–∞–±–æ—á–µ–π —Å–µ—Å—Å–∏–∏ –±–ª–∏–∑–∫–æ –∫ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–º—É ‚Äî —ç—Ç–æ —Ö–æ—Ä–æ—à–∏–π –∑–Ω–∞–∫, –Ω–æ –ª—ë–≥–∫–∞—è –ø—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏–∫–∞ –≤—Å—ë —Ä–∞–≤–Ω–æ –Ω–µ –±—É–¥–µ—Ç –ª–∏—à–Ω–µ–π.";
      }
      if (level === "mid") {
        return "–û—Ä–≥–∞–Ω–∏–∑–º —É–∂–µ –¥–∞—ë—Ç –ø–æ–Ω—è—Ç–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã: —É—Å—Ç–∞–ª–æ—Å—Ç—å –≤ —Å–ø–∏–Ω–µ, —à–µ–µ –∏–ª–∏ –Ω–æ–≥–∞—Ö. –≠—Ç–æ –ø–æ–≤–æ–¥ –º—è–≥–∫–æ –ø–æ–º–µ–Ω—è—Ç—å –ø–æ—Å–∞–¥–∫—É, –ø–æ–∫–∞ —Ç–µ–ª–æ –Ω–µ ¬´–∑–∞–∫—Ä–µ–ø–∏–ª–æ¬ª –Ω–µ—É–¥–∞—á–Ω—ã–µ –ø—Ä–∏–≤—ã—á–∫–∏.";
      }
      return "–¢–µ–ª–æ —Ä–µ–≥—É–ª—è—Ä–Ω–æ —Å–æ–æ–±—â–∞–µ—Ç –æ –ø–µ—Ä–µ–≥—Ä—É–∑–∫–µ: –≤—ã—Ä–∞–∂–µ–Ω–Ω–∞—è –±–æ–ª—å, —Ç—è–∂–µ—Å—Ç—å –∏–ª–∏ –±—ã—Å—Ç—Ä–∞—è —É—Ç–æ–º–ª—è–µ–º–æ—Å—Ç—å. –í —Ç–∞–∫–æ–π —Å–∏—Ç—É–∞—Ü–∏–∏ –ø–æ–ª–µ–∑–Ω–æ –º–µ–Ω—è—Ç—å –∏ –ø–æ—Å–∞–¥–∫—É, –∏ —Ä–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã (–ø–∞—É–∑—ã, –º–∏–∫—Ä–æ–¥–≤–∏–∂–µ–Ω–∏–µ, –≤—ã–±–æ—Ä –∫—Ä–µ—Å–ª–∞).";
    }

    function showResult() {
      // –§–∏–Ω–∞–ª—å–Ω—ã–π –ø—Ä–æ–≥—Ä–µ—Å—Å
      progressFill.style.width = "100%";

      // –°—á–∏—Ç–∞–µ–º –±–∞–ª–ª—ã –ø–æ –∑–æ–Ω–∞–º
      const scores = { lumbar: 0, neck: 0, legs: 0, general: 0 };
      questions.forEach(q => {
        const idx = answers[q.id];
        if (idx == null) return;
        const opt = q.options[idx];
        if (!opt.scores) return;
        for (const key in opt.scores) {
          scores[key] += opt.scores[key];
        }
      });

      const lumbarLevel = getRiskLevel(scores.lumbar);
      const neckLevel = getRiskLevel(scores.neck);
      const legsLevel = getRiskLevel(scores.legs);
      const generalLevel = getRiskLevel(scores.general);

      // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –æ—Å–Ω–æ–≤–Ω—É—é –∑–æ–Ω—É —Ä–∏—Å–∫–∞
      let mainZone = "—Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∫–∞—Ä—Ç–∏–Ω–∞";
      let mainKey = null;
      let maxScore = 0;
      for (const key of ["lumbar","neck","legs"]) {
        if (scores[key] > maxScore) {
          maxScore = scores[key];
          mainKey = key;
        }
      }
      if (mainKey === "lumbar") mainZone = "–ø–æ—è—Å–Ω–∏—Ü–∞ –∏ –Ω–∏–∂–Ω—è—è —á–∞—Å—Ç—å —Å–ø–∏–Ω—ã";
      else if (mainKey === "neck") mainZone = "—à–µ—è –∏ –≥–æ–ª–æ–≤–∞";
      else if (mainKey === "legs") mainZone = "–Ω–æ–≥–∏ –∏ —Å—Ç–æ–ø—ã";

      let warningText = "";
      if (scores.lumbar >= 4 || scores.neck >= 4 || scores.legs >= 4 || scores.general >= 3) {
        warningText = "‚ö†Ô∏è –¢–∞–∫–æ–µ —Å–æ—á–µ—Ç–∞–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–π —Ç–µ–ª–∞ –¥–∞—ë—Ç —Å—Ä–µ–¥–Ω–∏–π‚Äì–≤—ã—Å–æ–∫–∏–π —Ä–∏—Å–∫ —Ö—Ä–æ–Ω–∏—á–µ—Å–∫–æ–≥–æ –Ω–∞–ø—Ä—è–∂–µ–Ω–∏—è –∏ —É—Å—Ç–∞–ª–æ—Å—Ç–∏. –•–æ—Ä–æ—à–∞—è –Ω–æ–≤–æ—Å—Ç—å –≤ —Ç–æ–º, —á—Ç–æ –¥–∞–∂–µ –Ω–µ–±–æ–ª—å—à–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–æ—Å–∞–¥–∫–∏ –∑–∞–º–µ—Ç–Ω–æ —Å–Ω–∏–∂–∞—é—Ç –Ω–∞–≥—Ä—É–∑–∫—É.";
      }

      const zonesHtml = `
        <div class="result-title">üßæ –†–µ–∑—É–ª—å—Ç–∞—Ç —Ç–µ—Å—Ç–∞ –ø–æ—Å–∞–¥–∫–∏</div>
        <div class="result-intro">
          –ü–æ –æ—Ç–≤–µ—Ç–∞–º –≤–∏–¥–Ω–æ, –∫–∞–∫ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –Ω–∞–≥—Ä—É–∑–∫–∞ –º–µ–∂–¥—É –ø–æ—è—Å–Ω–∏—Ü–µ–π, —à–µ–µ–π –∏ –Ω–æ–≥–∞–º–∏.
          –û—Å–Ω–æ–≤–Ω–∞—è –∑–æ–Ω–∞, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–æ—Å–∏—Ç –≤–Ω–∏–º–∞–Ω–∏—è: <strong>${mainZone}</strong>.
        </div>

        <div class="zone-block">
          <div class="zone-header">
            <div class="zone-title">–ü–æ—è—Å–Ω–∏—Ü–∞</div>
            <div class="risk-pill ${lumbarLevel === "low" ? "risk-low" : lumbarLevel === "mid" ? "risk-mid" : "risk-high"}">
              ${riskLabel(lumbarLevel)}
            </div>
          </div>
          <div class="zone-text">
            ${riskSentence(lumbarLevel, "–ü–æ—è—Å–Ω–∏—Ü–∞")}
            <br><br>
            ${lumberText(lumbarLevel)}
          </div>
        </div>

        <div class="zone-block">
          <div class="zone-header">
            <div class="zone-title">–®–µ—è –∏ –≥–æ–ª–æ–≤–∞</div>
            <div class="risk-pill ${neckLevel === "low" ? "risk-low" : neckLevel === "mid" ? "risk-mid" : "risk-high"}">
              ${riskLabel(neckLevel)}
            </div>
          </div>
          <div class="zone-text">
            ${riskSentence(neckLevel, "–®–µ—è –∏ –≥–æ–ª–æ–≤–∞")}
            <br><br>
            ${neckText(neckLevel)}
          </div>
        </div>

        <div class="zone-block">
          <div class="zone-header">
            <div class="zone-title">–ù–æ–≥–∏ –∏ —Å—Ç–æ–ø—ã</div>
            <div class="risk-pill ${legsLevel === "low" ? "risk-low" : legsLevel === "mid" ? "risk-mid" : "risk-high"}">
              ${riskLabel(legsLevel)}
            </div>
          </div>
          <div class="zone-text">
            ${riskSentence(legsLevel, "–ù–æ–≥–∏ –∏ —Å—Ç–æ–ø—ã")}
            <br><br>
            ${legsText(legsLevel)}
          </div>
        </div>

        <div class="zone-block">
          <div class="zone-header">
            <div class="zone-title">–û–±—â–µ–µ —Å–∞–º–æ—á—É–≤—Å—Ç–≤–∏–µ</div>
            <div class="risk-pill ${generalLevel === "low" ? "risk-low" : generalLevel === "mid" ? "risk-mid" : "risk-high"}">
              ${riskLabel(generalLevel)}
            </div>
          </div>
          <div class="zone-text">
            ${riskSentence(generalLevel, "–û–±—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ")}
            <br><br>
            ${generalText(generalLevel)}
          </div>
        </div>

        ${warningText ? `<div class="result-warning">${warningText}</div>` : ""}
      `;

      resultBody.innerHTML = zonesHtml + chairsSectionHtml();
      attachCarouselLogic(); // –ø–æ–¥–∫–ª—é—á–∞–µ–º —Å–ª–∞–π–¥–µ—Ä
      showScreen(resultScreen);

      // –ü–ª–∞–≤–Ω–æ –ø–æ–∫–∞–∑ –º–æ–¥–∞–ª–∫–∏ —Å –∫—Ä–µ—Å–ª–∞–º–∏
      setTimeout(() => {
        chairsModal.classList.remove("hidden");
      }, 350);
    }

    // --- HTML –±–ª–æ–∫–∞ —Å –∫—Ä–µ—Å–ª–∞–º–∏ (–∏–∑–Ω–∞—á–∞–ª—å–Ω–æ —Å–∫—Ä—ã—Ç) ---
    function chairsSectionHtml() {
      return `
        <div id="chairsSection" class="chairs-section">
          <div class="chairs-title">üí∫ –ö—Ä–µ—Å–ª–∞ Samurai, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–º–æ–≥—É—Ç –ø–æ—Å–∞–¥–∫–µ</div>
          <div class="chairs-sub">
            –ù–∏–∂–µ ‚Äî –ø—Ä–∏–º–µ—Ä—ã –∫—Ä–µ—Å–µ–ª METTA –∏–∑ –ª–∏–Ω–µ–π–∫–∏ <strong>Samurai</strong> –Ω–∞ —Å–∞–π—Ç–µ
            <strong>samurai.wr-office.ru</strong>. –£ –Ω–∏—Ö –≤—ã—Ä–∞–∂–µ–Ω–Ω–∞—è –ø–æ—è—Å–Ω–∏—á–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞,
            –≤—ã—Å–æ–∫–∞—è —Å–ø–∏–Ω–∫–∞ –∏ –ø–æ–¥–≥–æ–ª–æ–≤–Ω–∏–∫ ‚Äî –≤—Å—ë, —á—Ç–æ –ø–æ–º–æ–≥–∞–µ—Ç —Ä–∞–∑–≥—Ä—É–∑–∏—Ç—å —Å–ø–∏–Ω—É –∏ —à–µ—é –ø—Ä–∏ –¥–æ–ª–≥–æ–π —Ä–∞–±–æ—Ç–µ.
          </div>

          <div class="carousel">
            <div id="carouselTrack" class="carousel-track">
              <div class="chair-card">
                <div class="chair-photo">
                  <div>
                    Samurai SL-3.04<br>
                    <span style="font-size:11px;font-weight:400;">–º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –æ–ø–æ—Ä–∞ –¥–ª—è —Å–ø–∏–Ω—ã –∏ —à–µ–∏</span>
                  </div>
                </div>
                <div class="chair-tag">–ü–æ—è—Å–Ω–∏—Ü–∞ + —à–µ—è</div>
                <div class="chair-name">Samurai SL-3.04</div>
                <div class="chair-desc">
                  –í—ã—Å–æ–∫–∞—è —Å–ø–∏–Ω–∫–∞ —Å –∞–Ω–∞—Ç–æ–º–∏—á–µ—Å–∫–∏–º –∏–∑–≥–∏–±–æ–º, –≤—ã—Ä–∞–∂–µ–Ω–Ω–∞—è –ø–æ—è—Å–Ω–∏—á–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –∏ —Ä–µ–≥—É–ª–∏—Ä—É–µ–º—ã–π –ø–æ–¥–≥–æ–ª–æ–≤–Ω–∏–∫.
                  –°–∏–Ω—Ö—Ä–æ–º–µ—Ö–∞–Ω–∏–∑–º –∏ —Å–ª–∞–π–¥–µ—Ä —Å–∏–¥–µ–Ω—å—è –ø–æ–º–æ–≥–∞—é—Ç —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –∫–æ–Ω—Ç–∞–∫—Ç —Å–ø–∏–Ω—ã —Å–æ —Å–ø–∏–Ω–∫–æ–π –¥–∞–∂–µ –ø—Ä–∏ —Å–º–µ–Ω–µ –ø–æ–∑—ã ‚Äî
                  —ç—Ç–æ —Å–Ω–∏–∂–∞–µ—Ç —Ä–∏—Å–∫ —Ç—è–Ω—É—â–µ–π –±–æ–ª–∏ –≤ –ø–æ—è—Å–Ω–∏—Ü–µ –∏ –Ω–∞–ø—Ä—è–∂–µ–Ω–∏—è –≤ —à–µ–µ.
                </div>
              </div>

              <div class="chair-card">
                <div class="chair-photo" style="background: radial-gradient(circle at 20% 0,#fee2e2 0,#fecaca 40%,#fca5a5 100%);">
                  <div>
                    Samurai SL-1<br>
                    <span style="font-size:11px;font-weight:400;">—É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ–µ –∫—Ä–µ—Å–ª–æ –¥–ª—è –¥–æ–ª–≥–æ–π —Ä–∞–±–æ—Ç—ã</span>
                  </div>
                </div>
                <div class="chair-tag">–ë–∞–ª–∞–Ω—Å –ø–æ—Å–∞–¥–∫–∏</div>
                <div class="chair-name">Samurai SL-1</div>
                <div class="chair-desc">
                  –ê–Ω–∞—Ç–æ–º–∏—á–µ—Å–∫–∞—è —Å–ø–∏–Ω–∫–∞, —Ä–µ–≥—É–ª–∏—Ä—É–µ–º—ã–π –ø–æ–¥–≥–æ–ª–æ–≤–Ω–∏–∫ –∏ –≥–∏–±–∫–∏–π ¬´–ø–æ–∑–≤–æ–Ω–æ—á–Ω–∏–∫¬ª —Å–ø–∏–Ω–∫–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è—é—Ç –Ω–∞–≥—Ä—É–∑–∫—É
                  –ø–æ –≤—Å–µ–π –¥–ª–∏–Ω–µ —Å–ø–∏–Ω—ã. –•–æ—Ä–æ—à–∏–π –≤–∞—Ä–∏–∞–Ω—Ç, –µ—Å–ª–∏ —É—Å—Ç–∞—é—Ç –∏ –ø–æ—è—Å–Ω–∏—Ü–∞, –∏ —à–µ—è, –∏ —Ö–æ—á–µ—Ç—Å—è ¬´—É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ–≥–æ —Å–æ–ª–¥–∞—Ç–∞¬ª
                  –¥–ª—è 6‚Äì12 —á–∞—Å–æ–≤ –∑–∞ —Å—Ç–æ–ª–æ–º.
                </div>
              </div>

              <div class="chair-card">
                <div class="chair-photo" style="background: radial-gradient(circle at 20% 0,#dcfce7 0,#bbf7d0 40%,#86efac 100%);">
                  <div>
                    Samurai c –≥–ª—É–±–æ–∫–æ–π —Ä–µ–≥—É–ª–∏—Ä–æ–≤–∫–æ–π<br>
                    <span style="font-size:11px;font-weight:400;">—É—Å—Ç–æ–π—á–∏–≤–∞—è –æ–ø–æ—Ä–∞ –¥–ª—è –Ω–æ–≥</span>
                  </div>
                </div>
                <div class="chair-tag">–ù–æ–≥–∏ –∏ —Å—Ç–æ–ø—ã</div>
                <div class="chair-name">Samurai (—Å–µ—Ä–∏—è —Å —Ä–µ–≥—É–ª–∏—Ä–æ–≤–∫–æ–π –≥–ª—É–±–∏–Ω—ã —Å–∏–¥–µ–Ω—å—è)</div>
                <div class="chair-desc">
                  –ú–æ–¥–µ–ª–∏ Samurai —Å —Ä–µ–≥—É–ª–∏—Ä–æ–≤–∫–æ–π –≥–ª—É–±–∏–Ω—ã –∏ –≤—ã—Å–æ—Ç—ã —Å–∏–¥–µ–Ω—å—è –ø–æ–º–æ–≥–∞—é—Ç –ø–æ—Å—Ç–∞–≤–∏—Ç—å —Å—Ç–æ–ø—ã –Ω–∞ –ø–æ–ª –∏–ª–∏ –ø–æ–¥—Å—Ç–∞–≤–∫—É,
                  —á—Ç–æ–±—ã –∫–æ–ª–µ–Ω–∏ –±—ã–ª–∏ –ø–æ–¥ —É–≥–ª–æ–º ~90¬∞. –≠—Ç–æ —É–º–µ–Ω—å—à–∞–µ—Ç –æ–Ω–µ–º–µ–Ω–∏–µ –∏ —Ç—è–∂–µ—Å—Ç—å –≤ –Ω–æ–≥–∞—Ö –ø—Ä–∏ –¥–ª–∏—Ç–µ–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç–µ.
                </div>
              </div>
            </div>

            <div class="carousel-nav">
              <button id="prevChair" class="carousel-btn">‚Äπ</button>
              <div class="carousel-dots">
                <div class="carousel-dot active" data-dot="0"></div>
                <div class="carousel-dot" data-dot="1"></div>
                <div class="carousel-dot" data-dot="2"></div>
              </div>
              <button id="nextChair" class="carousel-btn">‚Ä∫</button>
            </div>
          </div>

          <div class="chairs-cta">
            –•–æ—á–µ—à—å –ø—Ä–∏–º–µ—Ä–∏—Ç—å –∫—Ä–µ—Å–ª–æ –≤–∂–∏–≤—É—é –∏–ª–∏ –∑–∞–¥–∞—Ç—å –≤–æ–ø—Ä–æ—Å—ã –ø–æ –º–æ–¥–µ–ª—è–º Samurai?
            –ú–æ–∂–Ω–æ <strong>–Ω–∞–ø–∏—Å–∞—Ç—å –º–µ–Ω–µ–¥–∂–µ—Ä—É</strong> –∏–ª–∏ –ø—Ä–∏–µ—Ö–∞—Ç—å –≤ —à–æ—É—Ä—É–º METTA –≤ –ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫–µ.
            <div class="cta-buttons">
              <a class="cta-btn primary" href="https://t.me" target="_blank" rel="noopener noreferrer">
                üí¨ –ù–∞–ø–∏—Å–∞—Ç—å –º–µ–Ω–µ–¥–∂–µ—Ä—É
              </a>
              <a class="cta-btn" href="https://yandex.ru/maps/-/CLs8522j" target="_blank" rel="noopener noreferrer">
                üìç –ü—Ä–∏–π—Ç–∏ –≤ —Å–∞–ª–æ–Ω METTA (–ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫, –ö–æ–ª—ã–±–µ–ª—å–Ω–∞—è)
              </a>
            </div>
          </div>
        </div>
      `;
    }

    function attachCarouselLogic() {
      const track = document.getElementById("carouselTrack");
      const prevBtn = document.getElementById("prevChair");
      const nextBtn = document.getElementById("nextChair");
      const dots = document.querySelectorAll(".carousel-dot");
      if (!track || !prevBtn || !nextBtn) return;

      let index = 0;
      const total = 3;

      function updateCarousel() {
        const offset = -index * 100;
        track.style.transform = `translateX(${offset}%)`;
        dots.forEach((d, i) => {
          d.classList.toggle("active", i === index);
        });
      }

      prevBtn.addEventListener("click", () => {
        tactileTap();
        index = (index - 1 + total) % total;
        updateCarousel();
      });

      nextBtn.addEventListener("click", () => {
        tactileTap();
        index = (index + 1) % total;
        updateCarousel();
      });

      dots.forEach(d => {
        d.addEventListener("click", () => {
          tactileTap();
          const i = parseInt(d.dataset.dot, 10);
          if (!isNaN(i)) {
            index = i;
            updateCarousel();
          }
        });
      });
    }

    // --- –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–Ω–æ–ø–æ–∫ ---
    startTestBtn.addEventListener("click", () => {
      tactileTap();
      currentIndex = 0;
      showScreen(questionScreen);
      renderQuestion();
    });

    nextBtn.addEventListener("click", () => {
      tactileTap();
      goNextQuestion();
    });

    restartBtn.addEventListener("click", () => {
      tactileTap();
      // –æ—á–∏—Å—Ç–∫–∞
      for (const key in answers) delete answers[key];
      currentIndex = 0;
      selectedOptionIndex = null;
      document.getElementById("chairsSection")?.classList.remove("fade-enter");
      showScreen(questionScreen);
      renderQuestion();
    });

    showChairsBtn.addEventListener("click", () => {
      tactileTap();
      const section = document.getElementById("chairsSection");
      if (section) {
        section.style.display = "block";
        section.classList.add("fade-enter");
        section.scrollIntoView({ behavior: "smooth", block: "start" });
      }
    });

    chairsYesBtn.addEventListener("click", () => {
      tactileTap();
      chairsModal.classList.add("hidden");
      const section = document.getElementById("chairsSection");
      if (section) {
        section.style.display = "block";
        section.classList.add("fade-enter");
        section.scrollIntoView({ behavior: "smooth", block: "start" });
      }
    });

    chairsNoBtn.addEventListener("click", () => {
      tactileTap();
      chairsModal.classList.add("hidden");
    });

    chairsModal.addEventListener("click", (e) => {
      if (e.target === chairsModal) {
        tactileTap();
        chairsModal.classList.add("hidden");
      }
    });

    // –°—Ç–∞—Ä—Ç–æ–≤–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
    // (–Ω–∏—á–µ–≥–æ –Ω–µ –¥–µ–ª–∞–µ–º ‚Äî –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –∏–Ω—Ç—Ä–æ)
  </script>
</body>
</html>
